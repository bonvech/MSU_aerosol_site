{% block header %}
<header>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="{% if view_name != 'homepage' %} {{ url_for('home.index') }} {% else %} # {% endif %}">
      <img src="{{ url_for('static', filename='img/MSU_logo.png') }}" width="30" height="30" alt=""
           style="margin-left: 15px;">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link {% if view_name == 'homepage' %} active {% endif %}" href="{% if view_name != 'homepage' %} {{ url_for('home.index') }} {% else %} # {% endif %}">Главная</a>
        </li>
        <li class="nav-item">
          <a class="nav-link {% if view_name == 'about' %} active {% endif %}" href="#">О сайте</a>
        </li>
        <li class="nav-item">
          <a class="nav-link {% if view_name == 'devices' %} active {% endif %}" href="#">Контакты</a>
        </li>
        {% if user and user.is_authenticated and user.role.can_access_admin %}
          <li class="nav-item">
            <a class="nav-link {% if view_name == 'devices' %} active {% endif %}" href="{{ url_for('admin.admin_index') }}">Админка</a>
          </li>
        {% endif %}
        <div class="collapse navbar-collapse" id="navbarNavDarkDropdown">
          <ul class="navbar-nav">
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDarkDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Приборы
              </a>
              <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="navbarDarkDropdownMenuLink">
                {% for _, devices in complex_to_device.items() %}
                  {% for dev in devices %}
                    {% if dev.show %}
                      <li><a class="dropdown-item" href="{% if view_name != 'homepage' %} {{ url_for('home.index') }}#dev{{ dev.id }} {% else %} #dev{{ dev.id }} {% endif %}">{{ dev }}</a></li>
                    {% endif %}
                  {% endfor %}
                {% endfor %}
              </ul>
            </li>
          </ul>
        </div>
        <div class="collapse navbar-collapse" id="navbarNavDarkDropdown">
          <ul class="navbar-nav">
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDarkDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Комплексы
              </a>
              <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="navbarDarkDropdownMenuLink">
                {% for com, _ in complex_to_device.items() %}
                  <li><a class="dropdown-item" href="{% if view_name != 'homepage' %} {{ url_for('home.index') }}#com{{ com.id }} {% else %} #com{{ com.id }} {% endif %}">{{ com }}</a></li>
                {% endfor %}
              </ul>
            </li>
          </ul>
        </div>
      </ul>
    </div>
    {% if user and user.is_authenticated and user.role.can_access_admin %}
      <span class="badge bg-warning text-dark">Admin</span>
    {% endif %}
    {% if user and not user.is_authenticated %}
      <a type="button" href="{% if view_name not in ['registration', 'login'] %} {{ url_for('login.login') }} {% else %} # {% endif %}" class="btn btn-outline-dark ml-5" style="margin-right: 15px">Войти</a>
    {% elif user %}
      <a class="nav-link mx-3" href="{{ url_for('profile.user_profile') }}" style="float: right;">{{ user.login }}</a>
    {% endif %}  
  </nav>
</header>
{% endblock header %}